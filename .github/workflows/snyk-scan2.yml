name: Snyk vulnerability reports manual

on:
  workflow_dispatch:

jobs:
  cron:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout project
      uses: actions/checkout@v3
    - name: Scan vulnerabilities with snyk
      run: |
        cd scan-prj
        bash build-pom.sh
        npm install snyk -g
        snyk auth ${{ secrets.SNYK_TOKEN }}
        snyk test >> snyk-results.txt || true
        LINE_NUM=1
        while read LINE
        do
          if [[ $LINE == âœ— ]]
          then
            echo "${LINE_NUM}: ${LINE}"
          fi
          ((LINE_NUM++))
        done < snyk-results.txt